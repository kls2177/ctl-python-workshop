
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Part III: Working with Real Data &#8212; Basic and Intermediate Python</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://kls2177.github.io/ctl-python-workshop/chapters/index.html/chapters/intermediate/03_intermediate_python.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Exercises: Part III" href="03_intermediate_exercises.html" />
    <link rel="prev" title="Part II: Matplotlib" href="02_intermediate_python.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://kls2177.github.io/ctl-python-workshop/chapters/index.html/chapters/intermediate/03_intermediate_python.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Part III: Working with Real Data" />
<meta property="og:description" content="Part III: Working with Real Data  We have learned a lot about programming in python - the syntax and the functionality - but, for the most part, we have been us" />
<meta property="og:image"       content="https://kls2177.github.io/ctl-python-workshop/chapters/index.html/_static/python-logo-master-v3-TM.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/python-logo-master-v3-TM.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Basic and Intermediate Python</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Basic and Intermediate Python
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../basic/basic_intro.html">
   Module 1: Basic Python
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="intermediate_intro.html">
   Module 2: Intermediate Python
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_intermediate_python.html">
     Part I: NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01_intermediate_exercises.html">
     Exercises: Part I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_intermediate_python.html">
     Part II: Matplotlib
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Part III: Working with
     <em>
      Real Data
     </em>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_intermediate_exercises.html">
     Exercises: Part III
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="reflection.html">
     Reflection
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/intermediate/03_intermediate_python.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kls2177/ctl-python-workshop/master?urlpath=tree/chapters/intermediate/03_intermediate_python.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/kls2177/ctl-python-workshop/blob/master/chapters/intermediate/03_intermediate_python.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-the-data">
   1. Load the Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preliminary-data-exploration">
   2. Preliminary Data Exploration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#masked-arrays">
     2.1 Masked Arrays
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-the-data">
   3. Plotting the Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#more-plotting-options">
     3.1 More Plotting Options
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simple-statistical-analysis">
   4. Simple Statistical Analysis
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="part-iii-working-with-real-data">
<h1>Part III: Working with <em>Real Data</em><a class="headerlink" href="#part-iii-working-with-real-data" title="Permalink to this headline">¶</a></h1>
<p>We have learned a lot about programming in python - the syntax and the functionality - but, for the most part, we have been using fairly simple examples and data sets. So, let’s now take a look at how we might use python to work with some real data.</p>
<p>Download the following <a class="reference external" href="https://github.com/kls2177/ccia_files/blob/master/argo_float_4901412.npz?raw=true">file</a> and save it in the same directory that you are working in. The data we will be working with is ocean temperature, salinity, and pressure from an <a class="reference external" href="https://argo.ucsd.edu/">Argo float</a>.</p>
<p>Argo floats are amazing! They are autonomous floats that drift and dive throughout the ocean (see <a class="reference internal" href="#argo"><span class="std std-ref">Figure</span></a>) relaying information about temperature and salinity to satellites.</p>
<div class="figure align-default" id="argo">
<a class="reference internal image-reference" href="../../_images/argo.png"><img alt="../../_images/argo.png" src="../../_images/argo.png" style="width: 877.25px; height: 620.25px;" /></a>
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">Map of the position of operational Argo floats as of July 2020.</span><a class="headerlink" href="#argo" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="load-the-data">
<h2>1. Load the Data<a class="headerlink" href="#load-the-data" title="Permalink to this headline">¶</a></h2>
<p>The first thing we need to do is import NumPy and Matplotlib. See if you can remember the syntax for importing these packages.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<p>Now, let’s load the file. The <code class="docutils literal notranslate"><span class="pre">.npz</span></code> file format is a NumPy file format, so we can easily load this file using the <code class="docutils literal notranslate"><span class="pre">np.load()</span></code> function. Note that the raw Argo data does not come in such a nice file format - I made this part a bit easy for us :)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load data</span>
<span class="n">argo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;argo_float_4901412.npz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="preliminary-data-exploration">
<h2>2. Preliminary Data Exploration<a class="headerlink" href="#preliminary-data-exploration" title="Permalink to this headline">¶</a></h2>
<p>We can examine the data using some simple commands. Note that <code class="docutils literal notranslate"><span class="pre">.npz</span></code> files store NDarrays in a dictionary format. We can identify the different dictionary categories, using the below command.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display data categories</span>
<span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;S&#39;, &#39;T&#39;, &#39;levels&#39;, &#39;lon&#39;, &#39;date&#39;, &#39;P&#39;, &#39;lat&#39;]
</pre></div>
</div>
</div>
</div>
<p>So, we have seven categories. <strong>S</strong> is for salinity, <strong>T</strong> is for temperature and <strong>P</strong> is for pressure.</p>
<p>We can access the array in each category just as we did for dictionaries.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[18.97400093 18.43700027 19.09900093 ... 19.11300087 21.82299995
  20.13100052]
 [18.74099922 18.39999962 19.08200073 ... 18.47200012 19.45999908
  20.125     ]
 [18.37000084 18.37400055 19.06500053 ... 18.22999954 19.26199913
  20.07699966]
 ...
 [ 3.79299998  3.81399989  3.80200005 ...  3.80699992  3.81100011
   3.8599999 ]
 [ 3.76399994  3.77800012  3.75699997 ...  3.75399995  3.74600005
   3.80599999]
 [ 3.74399996  3.74600005  3.7249999  ...         nan  3.71399999
          nan]]
</pre></div>
</div>
</div>
</div>
<p>This looks like a lot of data. Let’s take a look at the shape of the <code class="docutils literal notranslate"><span class="pre">T</span></code> array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(78, 75)
</pre></div>
</div>
</div>
</div>
<p>Ok, it looks like we have a 2-D array. What do those two dimensions correspond to? See if you can try to figure out what these dimensions correspond to by printing out the shape of other variables. Click below to check your answer.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shape of array in &#39;levels&#39; category</span>
<span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;levels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># So, it looks like one of the dimensions corresponds to the number of pressure levels (i.e., the depth of the float).</span>
<span class="c1"># Let&#39;s take a closer look. What does `levels` look like?</span>

<span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;levels&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(78,)
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47
 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71
 72 73 74 75 76 77]
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We see that we simply have a set of consecutively numbered levels.</span>
<span class="c1"># What about the other dimension? </span>

<span class="c1"># Shape of array in &#39;date&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># The other dimension corresponds to `date`!</span>

<span class="c1"># data in &#39;date&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(75,)
[&#39;2012-07-13T22:33:06.019200000&#39; &#39;2012-07-23T22:54:59.990400000&#39;
 &#39;2012-08-02T22:55:52.003200000&#39; &#39;2012-08-12T23:08:59.971200000&#39;
 &#39;2012-08-22T23:29:01.968000000&#39; &#39;2012-09-01T23:17:38.976000000&#39;
 &#39;2012-09-12T02:59:18.960000000&#39; &#39;2012-09-21T23:18:37.036800000&#39;
 &#39;2012-10-02T03:00:17.971200000&#39; &#39;2012-10-11T23:13:27.984000000&#39;
 &#39;2012-10-22T02:50:32.006400000&#39; &#39;2012-10-31T23:36:39.974400000&#39;
 &#39;2012-11-11T02:40:46.041600000&#39; &#39;2012-11-20T23:08:29.990400000&#39;
 &#39;2012-12-01T02:47:51.993600000&#39; &#39;2012-12-10T23:23:16.972800000&#39;
 &#39;2012-12-21T02:58:48.979200000&#39; &#39;2012-12-30T23:07:23.030400000&#39;
 &#39;2013-01-10T02:56:43.008000000&#39; &#39;2013-01-19T23:24:26.956800000&#39;
 &#39;2013-01-30T02:43:53.011200000&#39; &#39;2013-02-08T23:15:27.043200000&#39;
 &#39;2013-02-19T01:12:50.976000000&#39; &#39;2013-02-28T23:07:13.008000000&#39;
 &#39;2013-03-11T02:43:30.979200000&#39; &#39;2013-03-20T23:17:22.992000000&#39;
 &#39;2013-03-31T01:50:38.025600000&#39; &#39;2013-04-09T23:19:07.968000000&#39;
 &#39;2013-04-20T02:53:29.990400000&#39; &#39;2013-04-29T23:28:33.024000000&#39;
 &#39;2013-05-10T02:50:18.009600000&#39; &#39;2013-05-19T23:21:05.990400000&#39;
 &#39;2013-05-30T02:50:30.969600000&#39; &#39;2013-06-08T23:32:49.027200000&#39;
 &#39;2013-06-19T03:42:51.004800000&#39; &#39;2013-06-28T23:32:16.022400000&#39;
 &#39;2013-07-09T03:28:30.979199999&#39; &#39;2013-07-18T23:33:57.974400000&#39;
 &#39;2013-07-29T03:15:42.019200000&#39; &#39;2013-08-07T23:25:02.035200000&#39;
 &#39;2013-08-18T01:47:44.966400000&#39; &#39;2013-08-28T03:02:59.020800000&#39;
 &#39;2013-09-07T03:03:51.984000000&#39; &#39;2013-09-16T23:32:07.987200000&#39;
 &#39;2013-09-27T04:08:27.974400000&#39; &#39;2013-10-06T23:25:39.964800000&#39;
 &#39;2013-10-17T02:55:50.995200000&#39; &#39;2013-10-27T03:45:47.001600000&#39;
 &#39;2013-11-06T01:14:52.022400000&#39; &#39;2013-11-16T03:29:54.009600000&#39;
 &#39;2013-11-26T03:03:56.995200000&#39; &#39;2013-12-05T23:33:59.011200000&#39;
 &#39;2013-12-16T02:58:01.977600000&#39; &#39;2013-12-25T23:22:43.017600000&#39;
 &#39;2014-01-05T02:52:06.009600000&#39; &#39;2014-01-14T23:41:18.009600000&#39;
 &#39;2014-01-25T03:00:43.977600000&#39; &#39;2014-02-03T23:29:13.977600000&#39;
 &#39;2014-02-14T02:50:11.961600000&#39; &#39;2014-02-23T23:03:21.974400000&#39;
 &#39;2014-03-06T02:58:03.964800000&#39; &#39;2014-03-15T23:10:28.012800000&#39;
 &#39;2014-03-26T02:51:22.032000000&#39; &#39;2014-04-04T23:25:58.972800000&#39;
 &#39;2014-04-15T03:00:45.964800000&#39; &#39;2014-04-24T23:24:40.003200000&#39;
 &#39;2014-05-05T02:56:22.012800000&#39; &#39;2014-05-15T00:10:06.009600000&#39;
 &#39;2014-05-25T03:02:43.036800000&#39; &#39;2014-06-03T23:34:53.961600000&#39;
 &#39;2014-06-14T03:01:23.980800000&#39; &#39;2014-06-23T23:24:31.968000000&#39;
 &#39;2014-07-04T03:08:30.019200000&#39; &#39;2014-07-13T23:47:43.008000000&#39;
 &#39;2014-07-24T03:02:33.014400000&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Looking at the dates, we see that data is collected every 20 days.</span>

<span class="c1"># Finally, what are the dimensions of the remaining variables?</span>

<span class="c1"># shape of remaining variables</span>
<span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(78, 75)
(78, 75)
(75,)
(75,)
</pre></div>
</div>
</div>
</div>
<p>Ok, so now we have a sense of how our data is organized. Often we know this before we even load the data, but sometimes we don’t.</p>
<p>Let’s perform a few other NumPy operations on data to get a sense of what our data looks like. For example, let’s find the maximum temperature value in our data set.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># find the maximum</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]))</span>

<span class="c1"># alternative way to find the maximum</span>
<span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nan
nan
</pre></div>
</div>
</div>
</div>
<p>Oops! Why are we getting <code class="docutils literal notranslate"><span class="pre">nan</span></code> (not-a-number) as the output? This usually means that there are invalid entries within column <code class="docutils literal notranslate"><span class="pre">T</span></code>.</p>
<p>If we examine the <code class="docutils literal notranslate"><span class="pre">T</span></code> column, you should see some entries are nan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[18.97400093 18.43700027 19.09900093 ... 19.11300087 21.82299995
  20.13100052]
 [18.74099922 18.39999962 19.08200073 ... 18.47200012 19.45999908
  20.125     ]
 [18.37000084 18.37400055 19.06500053 ... 18.22999954 19.26199913
  20.07699966]
 ...
 [ 3.79299998  3.81399989  3.80200005 ...  3.80699992  3.81100011
   3.8599999 ]
 [ 3.76399994  3.77800012  3.75699997 ...  3.75399995  3.74600005
   3.80599999]
 [ 3.74399996  3.74600005  3.7249999  ...         nan  3.71399999
          nan]]
</pre></div>
</div>
</div>
</div>
<p>We cannot proceed until this issue is resolved because many NumPy functions do not work properly if arrays contain <code class="docutils literal notranslate"><span class="pre">nan</span></code> values. We have a few options:</p>
<ul class="simple">
<li><p>Delete <code class="docutils literal notranslate"><span class="pre">nan</span></code> entries? You can’t delete the invalid entry, that will mess up the shape.</p></li>
<li><p>Manually assign place-holder values? This can be tedious.</p></li>
</ul>
<p>NumPy offers a convenient approach to dealing with <code class="docutils literal notranslate"><span class="pre">nan</span></code> values: We can use something called <a class="reference external" href="https://numpy.org/doc/stable/reference/maskedarray.generic.html"><strong>Masked Arrays</strong></a>.</p>
<div class="section" id="masked-arrays">
<h3>2.1 Masked Arrays<a class="headerlink" href="#masked-arrays" title="Permalink to this headline">¶</a></h3>
<p>Here we will “mask” out the invalid or <code class="docutils literal notranslate"><span class="pre">nan</span></code> values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mask nan values</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[18.974000930786133 18.437000274658203 19.099000930786133 ...
  19.113000869750977 21.822999954223633 20.131000518798828]
 [18.740999221801758 18.399999618530273 19.082000732421875 ...
  18.472000122070312 19.459999084472656 20.125]
 [18.3700008392334 18.374000549316406 19.065000534057617 ...
  18.229999542236328 19.261999130249023 20.07699966430664]
 ...
 [3.7929999828338623 3.813999891281128 3.802000045776367 ...
  3.806999921798706 3.811000108718872 3.859999895095825]
 [3.7639999389648438 3.7780001163482666 3.756999969482422 ...
  3.753999948501587 3.746000051498413 3.805999994277954]
 [3.74399995803833 3.746000051498413 3.7249999046325684 ... --
  3.7139999866485596 --]]
</pre></div>
</div>
</div>
</div>
<p>Above command will create a new masked array called T with all invalid entries masked (–).</p>
<p>The mask is simply an array with same shape as the originial data, with 0 and 1 as values. If value is 1, then corresponding data will be ignored.</p>
<p>Let’s look at masked arrays in a bit more detail using a simple example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a 1-D array with a nan value</span>
<span class="n">mx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">),</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 1.  2.  3. nan  5.]
</pre></div>
</div>
</div>
</div>
<p>If we try to compute the mean, for example, what will we get?</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate the mean of mx</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mx</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nan
</pre></div>
</div>
</div>
</div>
<p>We get a meaningless answer.</p>
<p>Instead, let’s create a mask that will tell NumPy to ignore the element with the <code class="docutils literal notranslate"><span class="pre">nan</span></code> value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a masked array</span>
<span class="n">mx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span> <span class="n">mask</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1 2 3 -- 5]
</pre></div>
</div>
</div>
</div>
<p>Now, what happens when we try to compute the mean?</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mx</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.75
</pre></div>
</div>
</div>
</div>
<p>Masked arrays are very powerful and can help to save a lot of time when dealing with missing data.</p>
<p>Ok, now back to our Argo data. We can now mask out all the <code class="docutils literal notranslate"><span class="pre">nan</span></code> values!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mask nan values</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">])</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">])</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">])</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-the-data">
<h2>3. Plotting the Data<a class="headerlink" href="#plotting-the-data" title="Permalink to this headline">¶</a></h2>
<p>First, let’s plot some simple time series of our data. Time series are line plots with time on the x-axis and the variable of interest on the y-axis.</p>
<p>To plot time series of this data, we have to pick a level that we are going to plot. Let’s pick the surface (level 0) and a level at-depth (level 60) and plot time series of <code class="docutils literal notranslate"><span class="pre">T</span></code> and <code class="docutils literal notranslate"><span class="pre">S</span></code>.</p>
<p>Before you click to reveal, try this on your own. Once you have something, first click to reveal the output and see if your plot looks similar to mine. If you’re stuck, click to reveal the code.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define figure size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="c1"># subplot 1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Surface&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span><span class="n">T</span><span class="p">[</span><span class="mi">60</span><span class="p">,:],</span><span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">60</span><span class="p">,:])))</span> <span class="o">+</span> <span class="s1">&#39; db&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature (Float 4901412)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$^{\circ}$C&#39;</span><span class="p">)</span> <span class="c1"># note: special syntax is required to make symbols</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

<span class="c1"># subplot 2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span><span class="n">S</span><span class="p">[</span><span class="mi">60</span><span class="p">,:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Salinity (Float 4901412)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;psu&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;psu&#39;)
</pre></div>
</div>
<img alt="../../_images/03_intermediate_python_33_1.png" src="../../_images/03_intermediate_python_33_1.png" />
</div>
</div>
<p>Do you see the seasonal cycle in the surface temperature data? Cool!</p>
<p>Now, let’s do a scatter plot. A <em>T-S</em> plot is a common way to plot ocean properties. Try it on your own: google “matplotlib scatter plot” to find the command.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a scatter plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">P</span><span class="p">)</span> <span class="c1"># color corresponds to P, pressure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f8e7fb3c940&gt;
</pre></div>
</div>
<img alt="../../_images/03_intermediate_python_35_1.png" src="../../_images/03_intermediate_python_35_1.png" />
</div>
</div>
<div class="section" id="more-plotting-options">
<h3>3.1 More Plotting Options<a class="headerlink" href="#more-plotting-options" title="Permalink to this headline">¶</a></h3>
<p>Let’s play around with matplotlib! It is more powerful than you think.</p>
<p>Try to style your scatter plot above:</p>
<ul class="simple">
<li><p>add labels to your x- and y-axes.</p></li>
<li><p>add a title</p></li>
<li><p>add a colourbar</p></li>
<li><p>add units to your colourbar</p></li>
<li><p>change the size of your figure</p></li>
<li><p>make your font larger</p></li>
</ul>
<p>If you get stuck, click to reveal.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot with title, labels and color bar</span>

<span class="c1"># change font size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>

<span class="c1"># define figure size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># scatter plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">P</span><span class="p">)</span>

<span class="c1"># title, labels, colourbar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;T-S Plot (Float 4901412)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;psu&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$^{\circ}$C&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;db&quot;</span><span class="p">)</span> <span class="c1"># Add color bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/03_intermediate_python_37_0.png" src="../../_images/03_intermediate_python_37_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="simple-statistical-analysis">
<h2>4. Simple Statistical Analysis<a class="headerlink" href="#simple-statistical-analysis" title="Permalink to this headline">¶</a></h2>
<p>Finally, let’s do a bit of statistical analysis of our data. NumPy has several <a class="reference external" href="https://numpy.org/doc/stable/reference/routines.statistics.html">statistical functions</a> that we can use.</p>
<p>Let’s see whether there is a clear relationship between latitude and surface salinity, i.e. does the surface salinity change as the float travels northward?</p>
<p>To investigate this, let’s first do a scatter plot of these two variabiles. Try on your own first.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot with title, labels and color bar</span>

<span class="c1"># change font size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>

<span class="c1"># define figure size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># scatter plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>

<span class="c1"># title, labels, colourbar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Surface Salinity versus Latitude (Float 4901412)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;psu&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/03_intermediate_python_39_0.png" src="../../_images/03_intermediate_python_39_0.png" />
</div>
</div>
<p>Looks like there is a fairly linear relationship between latitude and surface salinity with salinity decreasing the further north the float travels.</p>
<p>Let’s fit a line to this relationship using <code class="docutils literal notranslate"><span class="pre">np.polyfit()</span></code> and <code class="docutils literal notranslate"><span class="pre">np.polyval()</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">np.polyfit(x,y,n)</span></code> takes in the predictor (<code class="docutils literal notranslate"><span class="pre">x</span></code>), predictand (<code class="docutils literal notranslate"><span class="pre">y</span></code>) and fits a polynomial of degree-<code class="docutils literal notranslate"><span class="pre">n</span></code>. A straight line is a polynomial of degree-1. The output of this function are the coefficients of the fit (<code class="docutils literal notranslate"><span class="pre">a</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">np.polyval(a,x)</span></code> takes in the coefficients of the fit (<code class="docutils literal notranslate"><span class="pre">a</span></code>) and the predictor (<code class="docutils literal notranslate"><span class="pre">x</span></code>) and outputs the new fitted <code class="docutils literal notranslate"><span class="pre">y</span></code> values.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit a line (note: we will use np.ma.polyfit because S is a masked array)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># finds the slope and y-intercept for the best-fit line</span>

<span class="c1"># Find the new values of the line</span>
<span class="n">S_fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We usually also want to know how robust our linear fit is. To do this we want the <em>R</em>-squared value. This tells us what fraction of the variance in <code class="docutils literal notranslate"><span class="pre">S</span></code> if explained by <code class="docutils literal notranslate"><span class="pre">lat</span></code>.</p>
<p>Using NumPy, we can do this using the <code class="docutils literal notranslate"><span class="pre">np.corrcoef()</span></code> function, which computes the correlation matrix (<strong>R</strong>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate the correlation between lat and S</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.0 -0.8585086946368407]
 [-0.8585086946368407 1.0]]
</pre></div>
</div>
</div>
</div>
<p>We want the off-diagonal values. Thus, <em>R</em>-squared will just be the squared value of <em>R</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute the R**2</span>
<span class="n">Rsq</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Rsq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7370371787670521
</pre></div>
</div>
</div>
</div>
<p>Wow! Latitude explains about 74% for the variance in surface salinity.</p>
<p>Now, let’s add the linear fit and the <em>R</em>-squared information to our plot (as text). Try it on your own first.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot with title, labels and color bar</span>

<span class="c1"># change font size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>

<span class="c1"># define figure size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># scatter plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>

<span class="c1"># add linear fit</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">argo</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">S_fit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;linear fit (R$^2$ =&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Rsq</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span><span class="s1">&#39;%)&#39;</span><span class="p">)</span>

<span class="c1"># title, labels, colourbar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Surface Salinity versus Latitude (Float 4901412)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;psu&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/03_intermediate_python_47_0.png" src="../../_images/03_intermediate_python_47_0.png" />
</div>
</div>
<p>This is just a quick sampling of what you can do with NumPy. More sophisticated statistical and numerical analysis can be done with other Python packages, such as <a class="reference external" href="https://www.scipy.org/">SciPy</a> and <a class="reference external" href="https://www.statsmodels.org/stable/index.html">statsmodels</a>.</p>
<p>Now, it’s your turn to try some simple plotting and analysis.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "kls2177/ctl-python-workshop",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/intermediate"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="02_intermediate_python.html" title="previous page">Part II: Matplotlib</a>
    <a class='right-next' id="next-link" href="03_intermediate_exercises.html" title="next page">Exercises: Part III</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Karen Smith<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>